---
/**
 * Hero.astro
 * 
 * Mobile-optimized hero section with template-specific variants
 * Based on AI Council synthesis - optimized for phone call conversions
 * 
 * Key design decisions:
 * - All critical elements within first 600px (mobile fold)
 * - CTA button: 56px height, 12px border-radius
 * - Trust signals immediately visible
 * - Template-specific layouts and psychology
 */

import { site } from '../config/site';
import TrustBadges from './TrustBadges.astro';

interface Props {
  /** H1 headline */
  headline: string;
  /** Subheadline text */
  subheadline: string;
  /** Badge text above headline */
  badge?: string;
  /** Override CTA button text */
  ctaText?: string;
  /** Show process steps (technical template) */
  showProcess?: boolean;
  /** Process steps data */
  processSteps?: Array<{ title: string; desc: string }>;
}

const { 
  headline, 
  subheadline, 
  badge,
  ctaText,
  showProcess = false,
  processSteps = []
} = Astro.props;

const theme = site.theme;
const phoneLink = site.phoneLink || site.phone.replace(/\D/g, '');

// Template-specific CTA text
const defaultCtaText: Record<string, string> = {
  urgent: 'CALL NOW FOR IMMEDIATE HELP',
  premium: 'Schedule Design Consultation',
  standard: 'Get Your Free Estimate',
  technical: 'Schedule Site Assessment',
};

const displayCtaText = ctaText || defaultCtaText[theme] || 'Call Now';

// Template-specific trust badges text
const trustBadgesText: Record<string, string[]> = {
  urgent: ['24/7 Live Dispatch', 'Licensed & Insured', 'IICRC Certified'],
  premium: ['Award-Winning', 'Bespoke Design', 'Est. ' + (new Date().getFullYear() - parseInt(site.yearsInBusiness))],
  standard: ['Free Estimates', `${site.rating}‚òÖ Google Reviews`, 'Family Owned'],
  technical: ['EPA Certified', 'State Licensed', 'OSHA Compliant'],
};

const badges = trustBadgesText[theme] || trustBadgesText.standard;
---

<!-- ==========================================
     HERO SECTION - Template-specific variants
     ========================================== -->
<section class={`hero-section ${theme === 'urgent' ? 'urgent-hero' : ''}`}>
  
  {/* URGENT TEMPLATE: Dark background, emergency banner, red CTA */}
  {theme === 'urgent' && (
    <>
      <!-- Emergency Banner -->
      <div class="bg-accent-600 text-white text-center py-2 px-4">
        <p class="text-sm font-bold tracking-wide animate-pulse">
          ‚ö° 24/7 EMERGENCY SERVICE ‚Ä¢ LIVE DISPATCH ‚ö°
        </p>
      </div>
      
      <div class="max-w-6xl mx-auto px-4 py-8 md:py-16">
        <div class="text-center max-w-3xl mx-auto">
          <!-- H1 Headline -->
          <h1 class="hero-heading text-3xl sm:text-4xl lg:text-5xl font-bold mb-4 leading-tight">
            <Fragment set:html={headline} />
          </h1>
          
          <!-- Subheadline -->
          <p class="hero-subheading text-base sm:text-lg mb-6 max-w-2xl mx-auto">
            {subheadline}
          </p>
          
          <!-- Primary CTA -->
          <a
            href={`tel:${phoneLink}`}
            class="inline-flex items-center justify-center gap-3 btn-cta btn-cta-pulse px-8 py-4 rounded-cta text-lg font-bold shadow-lg hover:shadow-xl transition-all"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            {displayCtaText}
          </a>
          
          <!-- Trust Badges -->
          <div class="flex flex-wrap justify-center gap-4 mt-6">
            {badges.map((badge) => (
              <div class="flex items-center gap-2 text-sm text-gray-300">
                <span class="w-5 h-5 rounded-full bg-green-500 flex items-center justify-center text-white text-xs">‚úì</span>
                <span>{badge}</span>
              </div>
            ))}
          </div>
          
          <!-- Quick Stats -->
          <div class="grid grid-cols-3 gap-4 mt-8 max-w-md mx-auto">
            <div class="bg-white/5 rounded-xl p-4 text-center">
              <div class="text-2xl font-bold text-accent-400">30</div>
              <div class="text-xs text-gray-400">MIN RESPONSE</div>
            </div>
            <div class="bg-white/5 rounded-xl p-4 text-center">
              <div class="text-2xl font-bold text-accent-400">24/7</div>
              <div class="text-xs text-gray-400">AVAILABILITY</div>
            </div>
            <div class="bg-white/5 rounded-xl p-4 text-center">
              <div class="text-2xl font-bold text-accent-400">{site.reviewCount}</div>
              <div class="text-xs text-gray-400">JOBS DONE</div>
            </div>
          </div>
        </div>
      </div>
    </>
  )}

  {/* PREMIUM TEMPLATE: Clean white, elegant typography, gold accents */}
  {theme === 'premium' && (
    <div class="max-w-6xl mx-auto px-4 py-8 md:py-16">
      <!-- Hero Image Placeholder -->
      <div class="w-full h-64 md:h-80 bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl mb-8 flex items-center justify-center text-slate-500">
        [High-Quality Portfolio Image]
      </div>
      
      <div class="text-center max-w-3xl mx-auto">
        <!-- H1 Headline -->
        <h1 class="hero-heading text-3xl sm:text-4xl lg:text-5xl font-semibold mb-4 leading-tight">
          <Fragment set:html={headline} />
        </h1>
        
        <!-- Subheadline -->
        <p class="hero-subheading text-base sm:text-lg mb-8 max-w-2xl mx-auto">
          {subheadline}
        </p>
        
        <!-- Primary CTA -->
        <a
          href={`tel:${phoneLink}`}
          class="inline-flex items-center justify-center btn-cta px-8 py-4 rounded-lg text-base font-semibold transition-all"
        >
          {displayCtaText}
        </a>
        
        <!-- Secondary CTA -->
        <a href="#portfolio" class="block mt-4 text-gray-500 text-sm underline hover:text-gray-700">
          View Our Portfolio ‚Üí
        </a>
        
        <!-- Trust Badges -->
        <div class="flex justify-center gap-8 mt-8 pt-8 border-t border-gray-200">
          {badges.map((badge) => (
            <div class="text-center">
              <div class="w-16 h-8 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-400 mb-1">
                LOGO
              </div>
              <div class="text-xs text-gray-500">{badge}</div>
            </div>
          ))}
        </div>
      </div>
    </div>
  )}

  {/* STANDARD TEMPLATE: Clean white, green/orange, value-focused */}
  {theme === 'standard' && (
    <div class="max-w-6xl mx-auto px-4 py-8 md:py-16">
      <div class="grid lg:grid-cols-2 gap-8 items-center">
        <!-- Content Column -->
        <div>
          {badge && (
            <div class="inline-flex items-center gap-2 bg-primary-50 text-primary-700 text-xs font-semibold px-4 py-1.5 rounded-full mb-4">
              {badge}
            </div>
          )}
          
          <!-- H1 Headline -->
          <h1 class="hero-heading text-3xl sm:text-4xl font-bold mb-4 leading-tight">
            <Fragment set:html={headline} />
          </h1>
          
          <!-- Subheadline -->
          <p class="hero-subheading text-base sm:text-lg mb-6">
            {subheadline}
          </p>
          
          <!-- Benefit Tags -->
          <div class="flex flex-wrap gap-2 mb-6">
            {badges.map((badge) => (
              <span class="inline-flex items-center gap-1.5 bg-primary-50 text-primary-700 text-sm font-medium px-3 py-1.5 rounded-full">
                <span class="text-primary-500">‚úì</span>
                {badge}
              </span>
            ))}
          </div>
          
          <!-- Primary CTA -->
          <a
            href={`tel:${phoneLink}`}
            class="inline-flex items-center justify-center gap-2 btn-cta px-8 py-4 rounded-cta text-lg font-bold shadow-lg hover:shadow-xl transition-all w-full sm:w-auto"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            {displayCtaText}
          </a>
        </div>
        
        <!-- Image Column -->
        <div class="w-full h-64 md:h-80 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center text-white/70">
          [Team Photo / Work Image]
        </div>
      </div>
      
      <!-- Trust Bar -->
      <div class="flex justify-center items-center gap-6 mt-8 pt-6 border-t border-gray-200">
        <div class="text-center">
          <div class="text-yellow-400 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="text-xs text-gray-500">{site.rating} on Google ({site.reviewCount} reviews)</div>
        </div>
        <div class="text-center">
          <div class="text-sm font-bold text-gray-700">BBB</div>
          <div class="text-xs text-gray-500">A+ Rated</div>
        </div>
      </div>
    </div>
  )}

  {/* TECHNICAL TEMPLATE: Light grey, blue/green, process-focused */}
  {theme === 'technical' && (
    <div class="max-w-6xl mx-auto px-4 py-8 md:py-16">
      <div class="grid lg:grid-cols-5 gap-8 items-start">
        <!-- Content Column -->
        <div class="lg:col-span-3">
          <!-- Certification Badges -->
          <div class="flex flex-wrap gap-2 mb-4">
            {badges.map((badge) => (
              <span class="inline-flex items-center gap-1.5 bg-primary-50 border border-primary-200 text-primary-700 text-xs font-medium px-3 py-1.5 rounded-md">
                <span>üõ°Ô∏è</span>
                {badge}
              </span>
            ))}
          </div>
          
          <!-- H1 Headline -->
          <h1 class="hero-heading text-2xl sm:text-3xl lg:text-4xl font-bold mb-4 leading-tight">
            <Fragment set:html={headline} />
          </h1>
          
          <!-- Subheadline -->
          <p class="hero-subheading text-base sm:text-lg mb-6">
            {subheadline}
          </p>
          
          <!-- Primary CTA -->
          <a
            href={`tel:${phoneLink}`}
            class="inline-flex items-center justify-center gap-2 btn-cta px-8 py-4 rounded-lg text-base font-semibold shadow-lg hover:shadow-xl transition-all w-full sm:w-auto"
          >
            {displayCtaText}
          </a>
          
          <!-- License Info -->
          <p class="mt-4 text-sm text-gray-500">
            License #{site.licenseNumber} ‚Ä¢ Fully Insured & Bonded
          </p>
        </div>
        
        <!-- Process Box Column -->
        {showProcess && processSteps.length > 0 && (
          <div class="lg:col-span-2">
            <div class="bg-slate-900 text-white rounded-2xl p-6 shadow-xl">
              <h2 class="text-lg font-semibold mb-4">Our Certified Process</h2>
              <div class="space-y-4">
                {processSteps.map((step, index) => (
                  <div class="flex gap-3">
                    <div class="w-7 h-7 rounded-full bg-accent-500 flex items-center justify-center text-xs font-bold flex-shrink-0">
                      {index + 1}
                    </div>
                    <div>
                      <div class="text-sm font-semibold">{step.title}</div>
                      <div class="text-xs text-slate-300">{step.desc}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  )}
</section>

<style>
  /* Urgent hero dark background */
  .urgent-hero {
    background: var(--hero-bg);
    color: white;
  }
  
  .urgent-hero .hero-heading {
    color: white;
  }
  
  .urgent-hero .hero-subheading {
    color: #CBD5E1;
  }
</style>
