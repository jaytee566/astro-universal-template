---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import StickyMobileCTA from '../../components/StickyMobileCTA.astro';
import { site } from '../../config/site';

// ============================================
// STATIC PATHS - Generate Support pages
// Route: /[service-slug]/[support-slug]
// Example: /general-maintenance/complete-guide
// ============================================
export async function getStaticPaths() {
  // Standard support articles used by ALL services
  const standardArticles = [
    {
      slug: 'complete-guide',
      titleTemplate: 'Complete Guide to {service}',
      descriptionTemplate: 'Everything you need to know about professional {service} services.',
      readingTime: 6,
      content: [
        {
          heading: 'Why Professional Service Matters',
          paragraphs: [
            'Professional service is the key to protecting your property investment and avoiding costly problems. When you work with experienced technicians, you prevent small issues from becoming major expenses that disrupt your life and drain your wallet.',
            'Our trained experts have the expertise to spot early warning signs, use professional-grade tools, and apply solutions that last. We go beyond surface-level fixes to address root causes.',
          ],
        },
        {
          heading: 'What Does This Service Include?',
          paragraphs: [
            'A comprehensive service covers all the critical aspects of the job. This includes thorough inspections, proper preparation, quality workmanship, and attention to detail that ensures lasting results.',
            'The specific approach depends on your property type, age, and unique conditions. We customize our service to address your specific needs while following industry best practices.',
          ],
        },
        {
          heading: 'How to Know When You Need Service',
          paragraphs: [
            'Most properties benefit from proactive service rather than waiting for problems to appear. However, certain signs indicate immediate attention is needed. If you notice unusual conditions, reduced performance, or anything that seems off, it\'s time to call a professional.',
            'Even if everything seems fine, regular professional assessment catches hidden issues before they become expensive problems. Think of it as preventive care for your property.',
          ],
        },
        {
          heading: 'What to Expect When You Call Us',
          paragraphs: [
            'From your first call to project completion, we make the process smooth and stress-free. We provide clear communication, arrive on time, protect your property, and complete work to the highest standards.',
            'Our goal is your complete satisfaction. We\'re not done until you\'re thrilled with the results and confident in the quality of our work.',
          ],
        },
      ],
    },
    {
      slug: 'cost-factors',
      titleTemplate: '{service} Cost Factors',
      descriptionTemplate: 'Understanding what affects the price of professional {service} services.',
      readingTime: 5,
      content: [
        {
          heading: 'What Determines Service Costs?',
          paragraphs: [
            'The cost of professional service varies based on several factors specific to your property and needs. Understanding these factors helps you budget appropriately and make informed decisions.',
            'We believe in transparent pricing. We\'ll explain exactly what affects your quote and why, so there are never any surprises when the work is complete.',
          ],
        },
        {
          heading: 'Scope and Complexity',
          paragraphs: [
            'Larger or more complex projects naturally require more time, materials, and expertise. The specific conditions of your property, accessibility issues, and the extent of work needed all factor into the final cost.',
            'During our initial assessment, we\'ll clearly explain what affects your specific situation and provide a detailed estimate before any work begins.',
          ],
        },
        {
          heading: 'Quality of Materials and Workmanship',
          paragraphs: [
            'We use professional-grade materials that cost more than basic alternatives but deliver superior results and longevity. The skill and experience of our technicians also adds value that budget providers can\'t match.',
            'While you might find cheaper quotes elsewhere, the quality of our work and materials means you won\'t be calling someone else to fix problems in a few months.',
          ],
        },
        {
          heading: 'Getting the Best Value',
          paragraphs: [
            'The most cost-effective approach is getting it done right the first time. Quality service costs a fraction of having to redo poor workmanship or address recurring problems.',
            'We also offer maintenance plans and service packages that bundle services at a discounted rate. These plans include additional benefits that add value beyond the cost savings.',
          ],
        },
      ],
    },
    {
      slug: 'diy-vs-professional',
      titleTemplate: 'DIY vs Professional {service}',
      descriptionTemplate: 'When to handle {service} yourself and when to call the experts.',
      readingTime: 5,
      content: [
        {
          heading: 'The DIY Temptation',
          paragraphs: [
            'With countless online tutorials and home improvement content, it\'s tempting to handle everything yourself. Some tasks are indeed appropriate for handy homeownersâ€”but others require professional expertise.',
            'The key is knowing the difference. Getting it wrong can cost more than hiring a professional in the first place, not to mention the time, frustration, and potential safety risks.',
          ],
        },
        {
          heading: 'Tasks Suitable for DIY',
          paragraphs: [
            'Simple, low-risk tasks that don\'t require specialized tools or expertise are generally safe for homeowners to handle. These routine maintenance items have minimal risk and don\'t typically require licensing or permitting.',
            'However, even simple tasks benefit from professional expertise. We can complete them faster, better, and as part of a comprehensive service that addresses multiple needs at once.',
          ],
        },
        {
          heading: 'When to Call a Professional',
          paragraphs: [
            'Any task involving safety risks, complex systems, structural components, or code requirements should be left to licensed professionals. The risk of injury, property damage, or code violations is simply too high.',
            'Professional service also makes sense when you lack the time, tools, or physical ability to do the job properly. A half-done job can be worse than no action at all.',
          ],
        },
        {
          heading: 'The Hidden Costs of DIY',
          paragraphs: [
            'Consider the true cost of DIY: your time, the tools and materials you need to buy, the learning curve, the risk of mistakes, and the lack of warranty coverage. When you factor everything in, professional service is often the better value.',
            'Plus, professionals spot related issues you might miss. That early detection alone can save thousands in prevented problems.',
          ],
        },
      ],
    },
  ];

  // Services list
  const services = [
    { slug: 'general-maintenance', name: 'General Maintenance' },
    { slug: 'appliance-repair', name: 'Appliance Repair' },
    { slug: 'emergency-services', name: 'Emergency Services' },
  ];

  // Generate all support article pages
  const paths = [];

  for (const service of services) {
    for (let i = 0; i < standardArticles.length; i++) {
      const template = standardArticles[i];
      const prevTemplate = i > 0 ? standardArticles[i - 1] : null;
      const nextTemplate = i < standardArticles.length - 1 ? standardArticles[i + 1] : null;

      // Generate article with service-specific content
      const article = {
        slug: template.slug,
        title: template.titleTemplate.replace('{service}', service.name),
        description: template.descriptionTemplate.replace('{service}', service.name.toLowerCase()),
        readingTime: template.readingTime,
        content: template.content,
      };

      const prevArticle = prevTemplate ? {
        slug: prevTemplate.slug,
        title: prevTemplate.titleTemplate.replace('{service}', service.name),
      } : null;

      const nextArticle = nextTemplate ? {
        slug: nextTemplate.slug,
        title: nextTemplate.titleTemplate.replace('{service}', service.name),
      } : null;

      paths.push({
        params: {
          serviceSlug: service.slug,
          supportSlug: article.slug,
        },
        props: {
          service,
          article,
          prevArticle,
          nextArticle,
          siloOrder: i + 1,
          totalArticles: standardArticles.length,
        },
      });
    }
  }

  return paths;
}

// ============================================
// PAGE PROPS
// ============================================
const { service, article, prevArticle, nextArticle, siloOrder, totalArticles } = Astro.props;

// ============================================
// CRITICAL: Exact-match anchor text for linking UP to Silo Head
// This MUST match the siloHeadAnchor in the Silo Head page
// Format: "{Service Name} Austin TX"
// ============================================
const siloHeadAnchor = `${service.name} Austin TX`;
const siloHeadUrl = `/${service.slug}-${site.citySlug}`;
// Example anchor: "General Maintenance Austin TX"
// Example URL: "/general-maintenance-austin"

// ============================================
// PAGE METADATA
// ============================================
const pageData = {
  metaTitle: `${article.title} | ${service.name} in ${site.city} | ${site.businessName}`,
  metaDescription: `${article.description} Expert ${service.name.toLowerCase()} information from ${site.businessName} in ${site.city}, ${site.state}.`,
};

// ============================================
// CONTENT
// ============================================
const heroContent = {
  badge: `${service.name} Guide`,
  headline: article.title,
  description: article.description,
};

const ctaContent = {
  headline: `Need Professional ${service.name}?`,
  subheadline: `Our ${site.city} experts are ready to help. Call today to schedule a free assessment.`,
};
---

<Layout title={pageData.metaTitle} description={pageData.metaDescription}>
  <div class="bg-white text-gray-700">
    <Header />

    <!-- ==========================================
         BREADCRUMB - Full trail with EXACT-MATCH ANCHOR to Silo Head
         Format: Home > {Service} in Austin > Article Title
         This is CRITICAL for Kyle Roof SEO methodology
         ========================================== -->
    <nav class="bg-gray-50 border-b border-gray-200">
      <div class="max-w-6xl mx-auto px-5 sm:px-8 py-4">
        <ol class="flex flex-wrap items-center gap-2 text-sm">
          <!-- Home -->
          <li>
            <a href="/" class="text-gray-600 hover:text-primary-600 transition-colors">
              Home
            </a>
          </li>

          <!-- Separator -->
          <li class="text-gray-400">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </li>

          <!-- Silo Head - EXACT-MATCH ANCHOR TEXT -->
          <li>
            <a
              href={siloHeadUrl}
              class="text-primary-600 hover:text-primary-700 font-medium transition-colors"
            >
              {siloHeadAnchor}
            </a>
          </li>

          <!-- Separator -->
          <li class="text-gray-400">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </li>

          <!-- Current Article -->
          <li class="text-gray-900 font-medium">
            {article.title}
          </li>
        </ol>
      </div>
    </nav>

    <!-- ==========================================
         SECTION 1: HERO
         ========================================== -->
    <section class="hero-section py-12 md:py-16">
      <div class="max-w-4xl mx-auto px-5 sm:px-8">
        
        <!-- Article Badge -->
        <div class="inline-flex items-center gap-2 bg-primary-100 text-primary-600 text-sm font-semibold px-4 py-2 rounded-full mb-6">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          <span>{heroContent.badge}</span>
        </div>

        <!-- H1 -->
        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold hero-heading mb-6 leading-tight">
          {heroContent.headline}
        </h1>

        <!-- Description -->
        <p class="text-xl hero-subheading mb-8">
          {heroContent.description}
        </p>

        <!-- Article Meta -->
        <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500">
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>{article.readingTime} min read</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>{site.city}, {site.state}</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            <span>Article {siloOrder} of {totalArticles}</span>
          </div>
        </div>

      </div>
    </section>

    <!-- ==========================================
         SECTION 2: ARTICLE BODY
         ========================================== -->
    <section class="py-12 md:py-16 bg-white">
      <div class="max-w-4xl mx-auto px-5 sm:px-8">
        
        <article class="prose prose-lg max-w-none">
          {article.content.map((section) => (
            <div class="mb-12">
              <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6">
                {section.heading}
              </h2>
              {section.paragraphs.map((paragraph) => (
                <p class="text-gray-600 mb-4 text-lg leading-relaxed">
                  {paragraph}
                </p>
              ))}
            </div>
          ))}
        </article>

        <!-- Inline CTA -->
        <div class="bg-gray-50 rounded-2xl p-8 border border-gray-200 mt-12">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
            <div>
              <h3 class="text-xl font-bold text-gray-900 mb-2">
                Need Help with {service.name}?
              </h3>
              <p class="text-gray-600">
                Our {site.city} experts are ready to assist you.
              </p>
            </div>
            <a 
              href={`tel:${site.phoneLink}`}
              class="inline-flex items-center justify-center gap-2 bg-accent-600 hover:bg-accent-700 text-white font-bold px-6 py-3 rounded-xl transition-colors btn-cta whitespace-nowrap"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              <span>Call {site.phone}</span>
            </a>
          </div>
        </div>

      </div>
    </section>

    <!-- ==========================================
         SECTION 3: RELATED ARTICLES (Prev/Next in Silo)
         ONLY lateral links to other Support articles in SAME silo
         ========================================== -->
    <section class="py-12 md:py-16 bg-gray-50">
      <div class="max-w-4xl mx-auto px-5 sm:px-8">
        
        <h2 class="text-2xl font-bold text-gray-900 mb-8 text-center">
          Continue Reading
        </h2>

        <div class="grid md:grid-cols-2 gap-6">
          
          <!-- Previous Article -->
          {prevArticle ? (
            <a 
              href={`/${service.slug}/${prevArticle.slug}`}
              class="bg-white rounded-2xl p-6 border border-gray-200 hover:shadow-lg hover:border-primary-500 transition-all group"
            >
              <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                <span>Previous Article</span>
              </div>
              <h3 class="text-lg font-bold text-gray-900 group-hover:text-primary-600 transition-colors">
                {prevArticle.title}
              </h3>
            </a>
          ) : (
            <div class="bg-gray-100 rounded-2xl p-6 border border-gray-200 opacity-50">
              <div class="flex items-center gap-2 text-sm text-gray-400 mb-3">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                <span>Previous Article</span>
              </div>
              <p class="text-gray-400">You're at the first article</p>
            </div>
          )}

          <!-- Next Article -->
          {nextArticle ? (
            <a 
              href={`/${service.slug}/${nextArticle.slug}`}
              class="bg-white rounded-2xl p-6 border border-gray-200 hover:shadow-lg hover:border-primary-500 transition-all group"
            >
              <div class="flex items-center justify-end gap-2 text-sm text-gray-500 mb-3">
                <span>Next Article</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </div>
              <h3 class="text-lg font-bold text-gray-900 group-hover:text-primary-600 transition-colors text-right">
                {nextArticle.title}
              </h3>
            </a>
          ) : (
            <div class="bg-gray-100 rounded-2xl p-6 border border-gray-200 opacity-50">
              <div class="flex items-center justify-end gap-2 text-sm text-gray-400 mb-3">
                <span>Next Article</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </div>
              <p class="text-gray-400 text-right">You're at the last article</p>
            </div>
          )}

        </div>

      </div>
    </section>

    <!-- ==========================================
         SECTION 4: CTA BACK TO SILO HEAD
         Uses EXACT-MATCH anchor text
         ========================================== -->
    <section class="py-12 md:py-16 bg-white">
      <div class="max-w-4xl mx-auto px-5 sm:px-8">
        
        <div class="bg-primary-600 rounded-2xl p-8 md:p-12 text-center">
          <h2 class="text-2xl sm:text-3xl font-bold text-white mb-4">
            Ready for Professional {service.name}?
          </h2>
          <p class="text-primary-100 mb-8 text-lg max-w-2xl mx-auto">
            Now that you understand {article.title.toLowerCase()}, let our {site.city} experts put that knowledge to work for you.
          </p>
          
          <!-- CTA with EXACT-MATCH anchor to Silo Head -->
          <a 
            href={siloHeadUrl}
            class="inline-flex items-center gap-2 bg-white text-primary-600 font-bold px-8 py-4 rounded-xl hover:bg-gray-100 transition-colors text-lg"
          >
            <span>{siloHeadAnchor}</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>

      </div>
    </section>

    <!-- ==========================================
         SECTION 5: FINAL CTA
         ========================================== -->
    <section class="py-12 md:py-16 bg-gray-900">
      <div class="max-w-4xl mx-auto px-5 sm:px-8 text-center">
        
        <h2 class="text-2xl sm:text-3xl font-bold text-white mb-4">
          {ctaContent.headline}
        </h2>
        <p class="text-lg text-gray-300 mb-8">
          {ctaContent.subheadline}
        </p>

        <!-- Phone Button -->
        <a 
          href={`tel:${site.phoneLink}`}
          class="inline-flex items-center gap-3 bg-accent-600 hover:bg-accent-700 text-white font-bold text-xl px-8 py-5 rounded-2xl transition-colors btn-cta"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          <span>{site.phone}</span>
        </a>

        <!-- Trust Badges -->
        <div class="flex flex-wrap justify-center gap-6 mt-8 text-gray-400 text-sm">
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            <span>Free Assessments</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            <span>Licensed & Insured</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            <span>{site.rating}-Star Rated</span>
          </div>
        </div>

      </div>
    </section>

    <!-- Footer - Hide Service Areas (Kyle Roof: Support cannot link to neighborhoods) -->
    <Footer hideServiceAreas={true} />
    
    <!-- Mobile Sticky CTA -->
    <StickyMobileCTA />

  </div>
</Layout>
